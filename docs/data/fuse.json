{"keys":[{"path":["title"],"id":"title","weight":1,"src":"title","getFn":null},{"path":["body"],"id":"body","weight":1,"src":"body","getFn":null}],"records":[{"i":0,"$":{"0":{"v":"This page has not yet sprouted","n":0.408},"1":{"v":"[Dendron](https://dendron.so/) (the tool used to generate this site) lets authors selective publish content. You will see this page whenever you click on a link to an unpublished page\n\n![](https://foundation-prod-assetspublic53c57cce-8cpvgjldwysl.s3-us-west-2.amazonaws.com/assets/images/not-sprouted.png)","n":0.189}}},{"i":1,"$":{"0":{"v":"Python","n":1},"1":{"v":"\n## Setup\n\nInstall required components\n```\n\n```\n\n```\npdm init\n```","n":0.447}}},{"i":2,"$":{"0":{"v":"Urllib","n":1},"1":{"v":"\n## Sample GET request\n\n```python\nimport urllib.request\n\nf = urllib.request.urlopen('https://www.google.fr')\nprint(f.read().decode(f.info().get_content_charset()))\n```\n\n## Sample POST request\n\n```py\nfrom urllib.parse import urlencode\nfrom urllib.request import Request, urlopen\n\nurl = \"https://www.google.fr\"\ndata = urlencode({'test1': 1}).encode()\n\nreq = Request(url, data=data)\nres = urlopen(req)\n\nprint(res.read().decode(res.info().get_content_charset()))\n```\n","n":0.192}}},{"i":3,"$":{"0":{"v":"Argparse","n":1},"1":{"v":"\n## Basic argparse setup\n\n```python\nimport argparse\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-f\", \"--flag\", action='store_true') # Flag (default: false)\nparser.add_argument(\"-i\", \"--item\", type=str) # Optional\nparser.add_argument(\"x\", type=str) # Positional\nparser.parse_args()\n```\n","n":0.224}}},{"i":4,"$":{"0":{"v":"Environments","n":1}}},{"i":5,"$":{"0":{"v":"Windows","n":1},"1":{"v":"\n## Prerequisites\n\nInstall [scoop](https://scoop.sh)\n```powershell\niwr -useb get.scoop.sh | iex\n```\n\nInstall gsudo\n```powershell\nscoop install gsudo\n```\n\nUpdate Powershell Help\n```powershell\nUpdate-Help\n```\n\n## Openssh server\n\nFirst install the OpenSSH server \n```powershell\ngsudo \"Get-WindowsCapability -Online | Where-Object Name -like 'OpenSSH.Server'\"\ngsudo Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0\ngsudo Start-Service sshd\ngsudo Set-Service -Name sshd -StartupType 'Automatic'\n\nif (!(Get-NetFirewallRule -Name \"OpenSSH-Server-In-TCP\" -ErrorAction SilentlyContinue | Select-Object Name, Enabled)) {\n    Write-Output \"Firewall Rule 'OpenSSH-Server-In-TCP' does not exist, creating it...\"\n    New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22\n} else {\n    Write-Output \"Firewall rule 'OpenSSH-Server-In-TCP' has been created and exists.\"\n}\n```\n\nThen configure keys\n```powershell\nGet-Content .\\.ssh\\id_rsa.pub | Out-File -Append .\\.ssh\\authorized_keys\nNew-Item C:\\ProgramData\\ssh\\ -ItemType Directory\ngsudo \"Get-Content .\\.ssh\\id_rsa.pub | Out-File -Append C:\\ProgramData\\ssh\\administrators_authorized_keys\"\ngsudo \"icacls.exe 'C:\\ProgramData\\ssh\\administrators_authorized_keys' /inheritance:r /grant 'Administrators:F' /grant 'SYSTEM:F'\"\n```\n\nChange the default shell\n```powershell\ngsudo New-ItemProperty -Path \"HKLM:\\SOFTWARE\\OpenSSH\" -Name DefaultShell -Value \"C:\\Program Files\\powershell\\7\\pwsh.exe\" -PropertyType String -Force\n```\n\n## Keyboard rate\n\nTo set my preferred keyboard rate, either execute the following `.reg` file :\n\n```reg\nWindows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\Control Panel\\Accessibility\\Keyboard Response]\n\"AutoRepeatDelay\"=\"200\"\n\"AutoRepeatRate\"=\"6\"\n\"DelayBeforeAcceptance\"=\"0\"\n\"Flags\"=\"27\"\n\"BounceTime\"=\"0\"\n```\n\nOr execute these commands in a powershell :\n\n```powershell\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Accessibility\\Keyboard Response' -Name \"AutoRepeatDelay\" -Value \"200\"\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Accessibility\\Keyboard Response' -Name \"AutoRepeatRate\" -Value \"6\"\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Accessibility\\Keyboard Response' -Name \"DelayBeforeAcceptance\" -Value \"0\"\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Accessibility\\Keyboard Response' -Name \"Flags\" -Value \"27\"\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Accessibility\\Keyboard Response' -Name \"BounceTime\" -Value \"0\"\n```\n\n⚠️ Don't forget to logout for the changes to be seen ⚠️\n\n## Taskbar Hover time\n\n```powershell\nSet-ItemProperty -path 'HKCU:\\Control Panel\\Mouse' -Name \"MouseHoverTime\" -Value 200\n```\n\n## WSL\n\nInstall WSL\n```powershell\nwsl --install -d \"Ubuntu-20.04\"\n```\n\n## Fonts\n\nInstall NERD fonts\n```powershell\ngit clone --filter=blob:none --sparse git@github.com:ryanoasis/nerd-fonts\ncd nerd-fonts\ngit sparse-checkout add patched-fonts/CascadiaCode\n.\\install.ps1 CascadiaCode\n```\n\n## Clipboard\n\nInstall [win32yank](https://github.com/equalsraf/win32yank/latest/releases/download/win32yank-x64.zip)\n\nIn WSL \n```bash\ncurl -OL https://github.com/equalsraf/win32yank/releases/latest/download/win32yank-x64.zip\nunzip win32yank-x64.zip win32yank.exe -d ~/.local/bin/\nchmod +x ~/.local/bin/win32yank.exe\n```\n","n":0.065}}},{"i":6,"$":{"0":{"v":"Linux","n":1},"1":{"v":"\n## Dotfiles\n\nInstall yadm\n```bash\n# For ubuntu\nsudo apt install yadm\n\n# For arch\nyay -Syu yadm-git\n\n# For RHEL\ncurl -fLo /usr/local/bin/yadm https://github.com/TheLocehiliosan/yadm/raw/master/yadm && chmod a+x /usr/local/bin/yadm\n```\n\nThen install dotfiles\n\n```bash\n# Bootstrap only works on Ubuntu for now\nyadm clone git@github.com:joscherrer/dotfiles.git --bootstrap\n```\n","n":0.174}}},{"i":7,"$":{"0":{"v":"Keyboards","n":1},"1":{"v":"\nThis is the homepage for anything related to keyboards\n\n## QMK\n\nTo install QMK :\n\n- Follow the setup procedure on [QMK Documentation](docs.qmk.fm)\n- Run [this gist](https://gist.github.com/joscherrer/e1274d2c49884b12ed3f9af14dd3a4e7) to clone all the custom keymaps\n```bash\ncurl -fsSL https://git.io/J9GFJ | python3 - -f\n```\n\n## Keymaps\n\nTo create a new keymap :\n\n- Create a github repository\n- Set the following topics on the repo :\n    - `qmk`\n    - `kb--<keyboard>` (keyboard path with `/` replaced by `-`)\n    - `km--<keymap>`\n\nFor example, on a repo for the ai03 polaris keyboard the topics should be :\n- `qmk`\n- `kb--ai03-polaris`\n- `km--jonathan`\n\n### Example\n\n```bash\nprintf \"keyboard: \" >&2; read -r keyboard\nprintf \"keymap: \" >&2; read -r keymap\nprintf \"Repo name: \" >&2; read -r repo_name\nkeyboard=$(tr '/' '-' <<< $keyboard | sed 's/_/---/')\n\ngh repo create \"$repo_name\" --public\ngh repo edit joscherrer/$repo_name --add-topic qmk --add-topic \"km--${keymap}\" --add-topic \"kb--$keyboard\"\n```\n\n## Layout\n\nHere is my current layout\n\n![layout](/assets/images/keymap.png)\n\n### Accents\n\nTo write accentuated characters, you can use QMK combos.  \nPress a red letter key with a red accent key, or blue/blue, to get an accentuated character.\n\n![accents](/assets/images/accents.png)\n\nFor example `a+i` will give you `â`.\n\nThere is one exception : `î` is triggered by `f+i` as E and I collide for the circumflex.","n":0.075}}},{"i":8,"$":{"0":{"v":"Git","n":1},"1":{"v":"\n## Change past commit author\n\n### Interactive rebase\n\nInteractive rebase off of a point earlier in the history than the commit you need to modify (`git rebase -i <earliercommit>`). In the list of commits being rebased, change the text from `pick` to `edit` next to the hash of the one you want to modify. Then when git prompts you to change the commit, use this:\n\n    git commit --amend --author=\"Author Name <email@address.com>\" --no-edit\n\nFor example, if your commit history is `A-B-C-D-E-F` with `F` as `HEAD`, and you want to change the author of `C` and `D`, then you would...\n\n 1. Specify `git rebase -i B` ([here is an example of what you will see after executing the `git rebase -i B` command](https://help.github.com/articles/about-git-rebase/#an-example-of-using-git-rebase))\n * if you need to edit `A`, use `git rebase -i --root`\n 2. Change the lines for both `C` and `D` from `pick` to `edit`\n 3. Exit the editor (for vim, this would be pressing Esc and then typing `:wq`).\n 3. Once the rebase started, it would first pause at `C`\n 4. You would `git commit --amend --author=\"Author Name <email@address.com>\"`\n 5. Then `git rebase --continue`\n 6. It would pause again at `D`\n 7. Then you would `git commit --amend --author=\"Author Name <email@address.com>\"` again\n 8. `git rebase --continue`\n 9. The rebase would complete.\n 10. Use `git push -f` to update your origin with the updated commits.\n\n\n```bash\n# https://stackoverflow.com/questions/3042437/how-to-change-the-commit-author-for-one-specific-commit\ngit log # To find the commit hash - 1\ngit rebase -i <hash>\n# change pick to edit\ngit commit --amend --author=\"Jonathan Scherrer <jonathan.s.scherrer@gmail.com>\"\ngit rebase --continue\ngit push -f\n```\n\n### Replace\n\nThe [accepted answer][1] to this question is a wonderfully clever use of interactive rebase, but it unfortunately exhibits conflicts if the commit we are trying to change the author of used to be on a branch which was subsequently merged in. More generally, it does not work when handling messy histories.\n\nSince I am apprehensive about running scripts which depend on setting and unsetting environment variables to rewrite git history, I am writing a new answer based on [this post](https://help.github.com/articles/changing-author-info/) which is similar to [this answer](https://stackoverflow.com/a/3404304/391161) but is more complete.\n\nThe following is tested and working, unlike the linked answer.\nAssume for clarity of exposition that `03f482d6` is the commit whose author we are trying to replace, and `42627abe` is the commit with the new author. \n\n1. Checkout the commit we are trying to modify. \n      \n        git checkout 03f482d6\n2. Make the author change.\n\n        git commit --amend --author \"New Author Name <New Author Email>\"\n\n  Now we have a new commit with hash assumed to be `42627abe`.\n\n3. Checkout the original branch.\n\n4. Replace the old commit with the new one locally.\n\n        git replace 03f482d6 42627abe\n\n5. Rewrite all future commits based on the replacement.\n\n        git filter-branch -- --all\n\n6. Remove the replacement for cleanliness.\n\n        git replace -d 03f482d6\n\n7. Push the new history (only use --force if the below fails, and only after sanity checking with `git log` and/or `git diff`).\n\n        git push --force-with-lease\n\nInstead of 4-5 you can just rebase onto new commit:\n\n    git rebase -i 42627abe\n\n[1]: https://stackoverflow.com/a/3042512/3357935","n":0.045}}},{"i":9,"$":{"0":{"v":"Infrastructure","n":1},"1":{"v":"\nThis is the root of my infrastructure documentation.\n\n## Entrypoint\n\nTo manage my infrastructure, I have an [Ansible collection](https://github.com/jonsible/iac) that holds several roles and playbooks.\n\nI also have an [inventory repository](https://github.com/jonsible/inventory) which is private, that holds :\n- Bare machines, meaning bare-metal hosts and virtual machines that I pay for\n- VMs, meaning virtual machines that I provisioned in my KVM infrastructure.\n\n## Bootstrap\n\nUsually, the first role to run when creating a new server is the [bootstrap role](https://github.com/jonsible/iac/tree/master/roles/bootstrap).\n\n- It creates the default user (configured by the `default_user` variable)\n- Installs a public key in the user's `authorized_keys` by retrieving it from `github` (configured by the `github_user` variable)\n- Sets up passwordless sudo\n- Installs required components\n\n## Hardening\n\nThe [hardening role](https://github.com/jonsible/iac/tree/master/roles/hardening) will perform multiple steps to secure the server.\n\n- Remove `ufw`\n- Install iptables\n- Install and configure `fail2ban`\n- ","n":0.089}}},{"i":10,"$":{"0":{"v":"Kvm","n":1}}},{"i":11,"$":{"0":{"v":"Kubernetes","n":1}}},{"i":12,"$":{"0":{"v":"Storage","n":1},"1":{"v":"\n## NFS Storage class\n\nI don't want to install portworx, because it needs at least 4 cores and 4GB of memory when my server only has 4 cores (8 threads) and 32GB of RAM.  \nSo we'll use NFS for obvious reasons.\n\nThere is an NFS provisioner recommended by the Kubernetes documentation : [NFS Subdir External Provisioner](https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner)\n\nIt will create persistent volumes automatically and that's all I need.","n":0.125}}},{"i":13,"$":{"0":{"v":"Networking","n":1},"1":{"v":"\n## Ingress Controller\n\nThe ingress controller is a bunch of reverse proxies, that will be configured to redirect traffic onto desired services (defined by `Ingress` objects).\n\nWhen used on an \n\nSee : [ingress-nginx](https://kubernetes.github.io/ingress-nginx/)\n\n\n## LoadBalancer\n\nTo expose the ingress controller to the internet, we need some kind of ~~glorified reverse proxy~~ load balancer.\n\nOn promising solution is [MetalLB](https://metallb.universe.tf/), which enables native `LoadBalancer` kubernetes services.  \nHowever, it needs an allocable IP pool, which I don't have because I'm cheap.\n\nSo we're going to use a basic HAProxy to redirect all traffic to the ingress controller.  \nThe latter will be exposed on a `NodePort` service instead of a `LoadBalancer`.\n\n\n## Links\n\n[Bare-metal Kubernetes with Kubeadm, NGINX ingress controller and HAProxy](https://itnext.io/bare-metal-kubernetes-with-kubeadm-nginx-ingress-controller-and-haproxy-bb0a7ef29d4e)","n":0.095}}}]}
